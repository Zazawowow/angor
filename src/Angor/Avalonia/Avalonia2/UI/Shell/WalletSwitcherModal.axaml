<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:shell="clr-namespace:Avalonia2.UI.Shell"
             xmlns:i="https://github.com/projektanker/icons.avalonia"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="500"
             x:Class="Avalonia2.UI.Shell.WalletSwitcherModal"
             x:DataType="shell:ShellViewModel">

    <!--
        Shell-level wallet switcher modal.
        Vue: "Select Wallet" modal in App.vue (lines 6738-6794).
        Full overlay blur style — shown via ShellViewModel.ShowModal().
        Wallet list with selection, matching the "Use an existing wallet" visual pattern.
    -->
    <UserControl.Styles>
        <!-- Wallet card selection styles — CSS class toggling only, no BrushTransition (Rule #9) -->
        <Style Selector="Border.SwitcherWalletCard">
            <Setter Property="Background" Value="{DynamicResource DeployWalletItemBg}" />
            <Setter Property="BorderBrush" Value="{DynamicResource DeployWalletItemBorder}" />
        </Style>
        <Style Selector="Border.SwitcherWalletCard.WalletSelected">
            <Setter Property="Background" Value="{DynamicResource DeployWalletSelectedBg}" />
            <Setter Property="BorderBrush" Value="{DynamicResource DeployWalletSelectedBorder}" />
        </Style>
    </UserControl.Styles>

    <Panel>
        <!-- ════════════════════════════════════════════════════════════ -->
        <!-- MODAL: Select Wallet                                        -->
        <!-- Vue: rounded-2xl shadow-2xl max-w-md (448px), modal-fade    -->
        <!-- ════════════════════════════════════════════════════════════ -->
        <Border HorizontalAlignment="Center" VerticalAlignment="Center"
                MinWidth="420" MaxWidth="448"
                CornerRadius="16"
                Background="{DynamicResource DeployModalBackground}"
                BorderBrush="{DynamicResource DeployModalBorder}"
                BorderThickness="1"
                BoxShadow="0 8 32 0 #40000000"
                ClipToBounds="True"
                RenderTransformOrigin="50%,50%"
                RenderTransform="scale(1)">
            <Border.Transitions>
                <Transitions>
                    <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.3" />
                    <DoubleTransition Property="Opacity" Duration="0:0:0.3" />
                </Transitions>
            </Border.Transitions>
            <DockPanel>
                <!-- ── Header: "Select Wallet" + close button ── -->
                <!-- Vue: .modal-header — padding 24, border-bottom 1px #e5e7eb / #2a2a2a -->
                <Border DockPanel.Dock="Top" Padding="24"
                        BorderThickness="0,0,0,1"
                        CornerRadius="15,15,0,0"
                        BorderBrush="{DynamicResource DeployModalBorder}"
                        Background="{DynamicResource DeployModalBackground}">
                    <Panel>
                        <!-- Vue: .modal-title — font-size 20px, font-weight 700 -->
                        <TextBlock Text="Select Wallet"
                                   FontSize="20" FontWeight="Bold"
                                   Foreground="{DynamicResource TextStrong}"
                                   VerticalAlignment="Center" />
                        <Button Name="CloseWalletSwitcher" HorizontalAlignment="Right"
                                VerticalAlignment="Center" Background="Transparent"
                                Padding="4" Cursor="Hand" BorderThickness="0"
                                CornerRadius="6">
                            <!-- Vue: .modal-close-button — svg w-5 h-5 -->
                            <Viewbox Width="20" Height="20">
                                <Path Data="{StaticResource XMark}"
                                      Stroke="{DynamicResource ModalCloseBtn}" StrokeThickness="2"
                                      StrokeLineCap="Round" StrokeJoin="Round"
                                      Width="24" Height="24" Stretch="Uniform" />
                            </Viewbox>
                        </Button>
                    </Panel>
                </Border>

                <!-- ── Wallet list ── -->
                <!-- Vue: .modal-content padding: 24px; .wallet-options gap: 8px -->
                <ScrollViewer VerticalScrollBarVisibility="Auto"
                              MaxHeight="400">
                    <StackPanel Margin="24" Spacing="0">
                        <ItemsControl ItemsSource="{Binding SwitcherWallets}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate x:DataType="shell:WalletSwitcherItem">
                                    <!-- Vue: .wallet-option — padding 14 16, border 2px, rounded 8 -->
                                    <Border Name="WalletBorder" Classes="SwitcherWalletCard"
                                            CornerRadius="8" Padding="14,14,16,14"
                                            Margin="0,0,0,8"
                                            BorderThickness="2"
                                            Cursor="Hand">
                                        <Grid ColumnDefinitions="Auto,*,Auto">
                                            <!-- Wallet type icon container -->
                                            <!-- Vue: .wallet-option-icon-container — w-10 h-10 rounded-lg -->
                                            <Border Grid.Column="0" Width="40" Height="40"
                                                    CornerRadius="8"
                                                    Background="{DynamicResource DeployWalletIconBg}"
                                                    VerticalAlignment="Center">
                                                <!-- Bitcoin icon (default) -->
                                                <Panel>
                                                    <i:Icon Value="fa-brands fa-bitcoin"
                                                           FontSize="20"
                                                           Foreground="#F59E0B"
                                                           IsVisible="{Binding WalletType, Converter={x:Static StringConverters.IsNotNullOrEmpty}, FallbackValue=True}" />
                                                </Panel>
                                            </Border>

                                            <!-- Name + subtitle -->
                                            <!-- Vue: font-semibold text-white/text-gray-900 + text-sm text-gray-400/text-gray-500 -->
                                            <StackPanel Grid.Column="1" Spacing="2"
                                                        VerticalAlignment="Center" Margin="12,0,0,0">
                                                <TextBlock Text="{Binding Name}"
                                                           FontSize="14" FontWeight="SemiBold"
                                                           Foreground="{DynamicResource TextStrong}" />
                                                <TextBlock Text="{Binding Subtitle}"
                                                           FontSize="13"
                                                           Foreground="{DynamicResource TextMuted}" />
                                            </StackPanel>

                                            <!-- Balance + checkmark -->
                                            <StackPanel Grid.Column="2" Orientation="Horizontal"
                                                        Spacing="8" VerticalAlignment="Center">
                                                <!-- Vue: font-semibold text-white/text-gray-900 -->
                                                <TextBlock Text="{Binding FormattedBalance}"
                                                           FontSize="14" FontWeight="SemiBold"
                                                           Foreground="{DynamicResource TextStrong}"
                                                           VerticalAlignment="Center" />
                                                <!-- Checkmark for selected wallet -->
                                                <!-- Vue: svg w-5 h-5, fill currentColor, checkmark path -->
                                                <i:Icon Value="fa-solid fa-check"
                                                       FontSize="16"
                                                       Foreground="#4B7C5A"
                                                       IsVisible="{Binding IsSelected}"
                                                       VerticalAlignment="Center" />
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
            </DockPanel>
        </Border>
    </Panel>
</UserControl>
