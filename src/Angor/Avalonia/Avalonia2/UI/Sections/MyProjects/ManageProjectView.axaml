<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:mp="clr-namespace:Avalonia2.UI.Sections.MyProjects"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="1400"
             x:Class="Avalonia2.UI.Sections.MyProjects.ManageProjectView"
             x:DataType="mp:ManageProjectViewModel">

    <!--
        Vue ref: ManageFunds.vue — Manage Project detail screen.
        Layout: floating sticky nav at top, single scrollable column,
        max-width 1400px, 24px uniform section spacing (Rule 6).
    -->

    <UserControl.Styles>
        <!-- Floating nav button hover: lift + enhanced shadow (matches ProjectDetailView) -->
        <Style Selector="Border.FloatingBtn:pointerover">
            <Setter Property="RenderTransform" Value="translate(0px, -1px)" />
            <Setter Property="BoxShadow" Value="0 6 16 0 #33000000" />
        </Style>
        <!-- Kill FluentTheme button chrome on nav buttons -->
        <Style Selector="Button.NavBtn">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
        </Style>
        <Style Selector="Button.NavBtn:pointerover /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
        <Style Selector="Button.NavBtn:pressed /template/ ContentPresenter#PART_ContentPresenter">
            <Setter Property="Background" Value="Transparent" />
        </Style>
    </UserControl.Styles>

    <Panel>
        <!-- ═══ FLOATING NAV BAR (sticky at top, transparent bg) ═══ -->
        <!--
            Vue: .sticky-nav-bar — position: sticky, top 0, z-index 100,
            justify-content: space-between.
            Standardized pattern: DockPanel with Margin="24,24,24,0".
        -->
        <DockPanel VerticalAlignment="Top"
                   ZIndex="100"
                   Margin="24,24,24,0"
                   IsHitTestVisible="True">

            <!-- RIGHT: Private Keys, Refresh, Share (docked first so it hugs the right edge) -->
            <!-- Vue: .nav-right-buttons — gap 12 -->
            <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" Spacing="12">
                <!-- View Private Keys button -->
                <!-- Vue: .private-keys-button-floating — color #ea580c, h44 -->
                <Border Classes="FloatingBtn"
                        Background="{DynamicResource FloatingBtnBg}"
                        BorderBrush="{DynamicResource FloatingBtnBorder}"
                        BorderThickness="1"
                        CornerRadius="8"
                        BoxShadow="0 4 12 0 #26000000"
                        Padding="16,0,16,0"
                        Height="44"
                        VerticalAlignment="Center"
                        Cursor="Hand"
                        RenderTransform="translate(0px, 0px)">
                    <Border.Transitions>
                        <Transitions>
                            <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.2" />
                            <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                        </Transitions>
                    </Border.Transitions>
                    <Button Classes="NavBtn" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Cursor="Hand">
                        <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                            <Viewbox Width="16" Height="16" VerticalAlignment="Center">
                                <Path Data="{StaticResource Padlock}"
                                      Stroke="{DynamicResource PrivateKeysBtnText}"
                                      StrokeThickness="2"
                                      StrokeLineCap="Round" StrokeJoin="Round"
                                      Width="24" Height="24" Stretch="Uniform" />
                            </Viewbox>
                            <TextBlock Text="View Private Keys"
                                       FontSize="14" FontWeight="Medium"
                                       Foreground="{DynamicResource PrivateKeysBtnText}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                </Border>

                <!-- Refresh button (icon only) -->
                <!-- Vue: .refresh-button-floating — w44 h44 -->
                <Border Classes="FloatingBtn"
                        Background="{DynamicResource FloatingBtnBg}"
                        BorderBrush="{DynamicResource FloatingBtnBorder}"
                        BorderThickness="1"
                        CornerRadius="8"
                        BoxShadow="0 4 12 0 #26000000"
                        Width="44" Height="44"
                        VerticalAlignment="Center"
                        Cursor="Hand"
                        RenderTransform="translate(0px, 0px)">
                    <Border.Transitions>
                        <Transitions>
                            <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.2" />
                            <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                        </Transitions>
                    </Border.Transitions>
                    <Button Classes="NavBtn" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Cursor="Hand">
                        <Viewbox Width="16" Height="16" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Path Data="{StaticResource RefreshArrows}"
                                  Stroke="{DynamicResource TextStrong}"
                                  StrokeThickness="2"
                                  StrokeLineCap="Round" StrokeJoin="Round"
                                  Width="24" Height="24" Stretch="Uniform" />
                        </Viewbox>
                    </Button>
                </Border>

                <!-- Share button (icon only) -->
                <!-- Vue: .share-button-floating — w44 h44 -->
                <Border Classes="FloatingBtn"
                        Background="{DynamicResource FloatingBtnBg}"
                        BorderBrush="{DynamicResource FloatingBtnBorder}"
                        BorderThickness="1"
                        CornerRadius="8"
                        BoxShadow="0 4 12 0 #26000000"
                        Width="44" Height="44"
                        VerticalAlignment="Center"
                        Cursor="Hand"
                        RenderTransform="translate(0px, 0px)">
                    <Border.Transitions>
                        <Transitions>
                            <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.2" />
                            <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                        </Transitions>
                    </Border.Transitions>
                    <Button Classes="NavBtn" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Cursor="Hand">
                        <Viewbox Width="16" Height="16" HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Path Data="{StaticResource Share}"
                                  Stroke="{DynamicResource TextStrong}"
                                  StrokeThickness="2"
                                  StrokeLineCap="Round" StrokeJoin="Round"
                                  Width="24" Height="24" Stretch="Uniform" />
                        </Viewbox>
                    </Button>
                </Border>
            </StackPanel>

            <!-- LEFT: Back + Project Name (after Right so DockPanel pushes Right to edge) -->
            <StackPanel DockPanel.Dock="Left" Orientation="Horizontal" Spacing="12">
                <!-- Back button — standardized: ChevronLeftThick + Fill (matches all other nav bars) -->
                <Border Classes="FloatingBtn"
                        Background="{DynamicResource FloatingBtnBg}"
                        BorderBrush="{DynamicResource FloatingBtnBorder}"
                        BorderThickness="1"
                        CornerRadius="8"
                        BoxShadow="0 4 12 0 #26000000"
                        Padding="16,0,16,0"
                        Height="44"
                        VerticalAlignment="Center"
                        Cursor="Hand"
                        RenderTransform="translate(0px, 0px)">
                    <Border.Transitions>
                        <Transitions>
                            <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.2" />
                            <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                        </Transitions>
                    </Border.Transitions>
                    <Button Name="BackButton"
                            Classes="NavBtn"
                            VerticalAlignment="Stretch"
                            HorizontalAlignment="Stretch"
                            Cursor="Hand">
                        <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                            <Viewbox Width="10" Height="16">
                                <Path Data="{StaticResource ChevronLeftThick}"
                                      Fill="{DynamicResource TextStrong}"
                                      Width="320" Height="512" Stretch="Uniform" />
                            </Viewbox>
                            <TextBlock Text="Back"
                                       FontSize="14" FontWeight="Medium"
                                       Foreground="{DynamicResource TextStrong}"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                    </Button>
                </Border>

                <!-- Project Name pill -->
                <Border Classes="FloatingBtn"
                        Background="{DynamicResource FloatingBtnBg}"
                        BorderBrush="{DynamicResource FloatingBtnBorder}"
                        BorderThickness="1"
                        CornerRadius="8"
                        BoxShadow="0 4 12 0 #26000000"
                        Height="44"
                        Padding="16,0,16,0"
                        VerticalAlignment="Center"
                        RenderTransform="translate(0px, 0px)">
                    <Border.Transitions>
                        <Transitions>
                            <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.2" />
                            <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                        </Transitions>
                    </Border.Transitions>
                    <TextBlock Text="{Binding Project.Name}"
                               FontSize="14" FontWeight="SemiBold"
                               Foreground="{DynamicResource TextStrong}"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis"
                               MaxWidth="400" />
                </Border>
            </StackPanel>
        </DockPanel>

        <!-- ═══ SCROLLABLE CONTENT ═══ -->
        <!--
            Vue: .content-grid — gap 24. Rule 6: 24px uniform section spacing.
            .main-column — max-width 1400px.
            Spacer at top: nav margin(24) + nav height(44) + gap(24) = 92px.
        -->
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <Panel>
                <StackPanel Spacing="24"
                            Margin="24,0,24,24">
                    <!-- Spacer for floating nav: 24 (nav top margin) + 44 (nav h) + 24 (gap below) = 92 -->
                    <Panel Height="92" />

                    <!-- ═══ 1. PROJECT ID CARD ═══ -->
                    <!--
                        Vue: .detail-card.project-id-card — bg white/#1a1a1a, border 1px #e0e0e0/#404040,
                        rounded 16, padding 24, shadow.
                        Content: project-id-info (label + monospace value) + project-id-actions (Edit, View, Copy)
                    -->
                    <Border Background="{DynamicResource DetailCardBg}"
                            BorderBrush="{DynamicResource DetailCardBorder}"
                            BorderThickness="1"
                            CornerRadius="16"
                            Padding="24"
                            BoxShadow="0 2 8 0 #1A000000">
                        <Grid ColumnDefinitions="*,Auto">
                            <!-- Left: Label + value -->
                            <StackPanel Grid.Column="0" Spacing="4" VerticalAlignment="Center">
                                <!-- Vue: .project-id-label — font-size 13px -->
                                <TextBlock Text="Project ID"
                                           FontSize="13" FontWeight="Medium"
                                           Foreground="{DynamicResource ProjectIdLabel}" />
                                <!-- Vue: .project-id-value — font-size 14px, monospace, word-break -->
                                <TextBlock Text="{Binding ProjectId}"
                                           FontSize="14" FontWeight="Normal"
                                           Foreground="{DynamicResource ProjectIdValue}"
                                           FontFamily="Courier New, monospace"
                                           TextWrapping="Wrap" />
                            </StackPanel>

                            <!-- Right: Action buttons -->
                            <!-- Vue: .project-id-actions — gap 8 -->
                            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8"
                                        VerticalAlignment="Center">
                                <!-- Edit Project button -->
                                <!-- Vue: .edit-project-button — pad 6 12, rounded 6, border #d1d5db, color #4B7C5A, font 13px -->
                                <Button Background="Transparent"
                                        BorderBrush="{DynamicResource ProjectActionBtnBorder}"
                                        BorderThickness="1"
                                        CornerRadius="6"
                                        Padding="12,6">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <Viewbox Width="14" Height="14" VerticalAlignment="Center">
                                            <Path Data="{StaticResource Pencil}"
                                                  Stroke="{DynamicResource ProjectActionBtnText}"
                                                  StrokeThickness="2"
                                                  StrokeLineCap="Round" StrokeJoin="Round"
                                                  Width="24" Height="24" Stretch="Uniform" />
                                        </Viewbox>
                                        <TextBlock Text="Edit Project"
                                                   FontSize="13" FontWeight="Medium"
                                                   Foreground="{DynamicResource ProjectActionBtnText}"
                                                   VerticalAlignment="Center" />
                                    </StackPanel>
                                </Button>

                                <!-- See Live Project button -->
                                <Button Background="Transparent"
                                        BorderBrush="{DynamicResource ProjectActionBtnBorder}"
                                        BorderThickness="1"
                                        CornerRadius="6"
                                        Padding="12,6">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <Viewbox Width="14" Height="14" VerticalAlignment="Center">
                                            <Path Data="{StaticResource Eye}"
                                                  Stroke="{DynamicResource ProjectActionBtnText}"
                                                  StrokeThickness="2"
                                                  StrokeLineCap="Round" StrokeJoin="Round"
                                                  Width="24" Height="24" Stretch="Uniform" />
                                        </Viewbox>
                                        <TextBlock Text="See Live Project"
                                                   FontSize="13" FontWeight="Medium"
                                                   Foreground="{DynamicResource ProjectActionBtnText}"
                                                   VerticalAlignment="Center" />
                                    </StackPanel>
                                </Button>

                                <!-- Copy button (icon only) -->
                                <!-- Vue: .copy-button — pad 8, rounded 6, color #6b7280 -->
                                <Button Background="Transparent"
                                        BorderThickness="0"
                                        CornerRadius="6"
                                        Padding="8">
                                    <Viewbox Width="18" Height="18">
                                        <Path Data="{StaticResource Copy}"
                                              Stroke="{DynamicResource ProjectIdLabel}"
                                              StrokeThickness="2"
                                              StrokeLineCap="Round" StrokeJoin="Round"
                                              Width="24" Height="24" Stretch="Uniform" />
                                    </Viewbox>
                                </Button>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- ═══ 2. PROJECT STATISTICS CARD (orange gradient) ═══ -->
                    <!--
                        Vue: .detail-card.stats-detail-card — orange gradient bg, border.
                        Header: bitcoin icon circle + "Project Statistics" title.
                        Body: 4-col stats grid.
                    -->
                    <Border Background="{DynamicResource StatsDetailCardBackground}"
                            BorderBrush="{DynamicResource StatsDetailCardBorder}"
                            BorderThickness="1"
                            CornerRadius="16"
                            Padding="24"
                            BoxShadow="0 2 8 0 #1A000000">
                        <StackPanel Spacing="16">
                            <!-- Header: Bitcoin icon + Title -->
                            <!-- Vue: .card-header.stats-card-header — gap 12 -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <!-- Bitcoin icon circle -->
                                <!-- Vue: .bitcoin-icon-circle — 40px, rounded full, gradient 135deg #f7931a → #e08116 -->
                                <Border Width="40" Height="40" CornerRadius="20">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                            <GradientStop Color="#F7931A" Offset="0" />
                                            <GradientStop Color="#E08116" Offset="1" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <Viewbox Width="20" Height="20"
                                             HorizontalAlignment="Center"
                                             VerticalAlignment="Center">
                                        <Path Data="{StaticResource BitcoinSymbol}"
                                              Fill="White"
                                              Width="24" Height="24" Stretch="Uniform" />
                                    </Viewbox>
                                </Border>
                                <!-- Vue: .stats-card-title — font-size 18, font-weight 600, color #92400e/#fdba74 -->
                                <TextBlock Text="Project Statistics"
                                           FontSize="18" FontWeight="SemiBold"
                                           Foreground="{DynamicResource StatsCardTitle}"
                                           VerticalAlignment="Center" />
                            </StackPanel>

                            <!-- Stats Grid: 4 columns -->
                            <!-- Vue: .stats-grid — grid-template-columns repeat(4,1fr), gap 16 -->
                            <UniformGrid Columns="4" Rows="1">
                                <!-- Total Investment -->
                                <Border Background="{DynamicResource StatCardBackground}"
                                        BorderBrush="{DynamicResource StatCardBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="0,0,8,0">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Total Investment"
                                                   FontSize="13" FontWeight="Medium"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                        <TextBlock Text="{Binding TotalInvestment, StringFormat={}{0} BTC}"
                                                   FontSize="20" FontWeight="Bold"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                    </StackPanel>
                                </Border>

                                <!-- Available Balance -->
                                <Border Background="{DynamicResource StatCardBackground}"
                                        BorderBrush="{DynamicResource StatCardBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="8,0,8,0">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Available Balance"
                                                   FontSize="13" FontWeight="Medium"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                        <TextBlock Text="{Binding AvailableBalance, StringFormat={}{0} BTC}"
                                                   FontSize="20" FontWeight="Bold"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                    </StackPanel>
                                </Border>

                                <!-- Withdrawable -->
                                <Border Background="{DynamicResource StatCardBackground}"
                                        BorderBrush="{DynamicResource StatCardBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="8,0,8,0">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Withdrawable"
                                                   FontSize="13" FontWeight="Medium"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                        <TextBlock Text="{Binding Withdrawable, StringFormat={}{0} BTC}"
                                                   FontSize="20" FontWeight="Bold"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                    </StackPanel>
                                </Border>

                                <!-- Total Stages -->
                                <Border Background="{DynamicResource StatCardBackground}"
                                        BorderBrush="{DynamicResource StatCardBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="8,0,0,0">
                                    <StackPanel Spacing="12">
                                        <TextBlock Text="Total Stages"
                                                   FontSize="13" FontWeight="Medium"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                        <TextBlock Text="{Binding TotalStages}"
                                                   FontSize="20" FontWeight="Bold"
                                                   Foreground="{DynamicResource StatsCardTitle}" />
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                        </StackPanel>
                    </Border>

                    <!-- ═══ 3. NEXT STAGE + TRANSACTION STATISTICS (side by side) ═══ -->
                    <!-- Vue: .stats-row-container — grid-template-columns 1fr 1fr, gap 24 -->
                    <Grid ColumnDefinitions="*,24,*">
                        <!-- ── Left: Next Stage Countdown ── -->
                        <!-- Vue: .detail-card.next-stage-detail-card — green gradient bg/border -->
                        <Border Grid.Column="0"
                                Background="{DynamicResource NextStageCardBackground}"
                                BorderBrush="{DynamicResource NextStageCardBorder}"
                                BorderThickness="1"
                                CornerRadius="16"
                                Padding="24"
                                BoxShadow="0 2 8 0 #1A000000">
                            <StackPanel Spacing="16">
                                <!-- Header: title only -->
                                <!-- Vue: .next-stage-title — color #4B7C5A/#5FAF78 -->
                                <TextBlock Text="Next Stage"
                                           FontSize="20" FontWeight="Bold"
                                           Foreground="{DynamicResource NextStageTitle}" />

                                <!-- 3-col countdown grid -->
                                <!-- Vue: .next-stage-grid — repeat(3,1fr), gap 16 -->
                                <UniformGrid Columns="3" Rows="1">
                                    <!-- Days -->
                                    <Border Background="{DynamicResource NextStageInnerBackground}"
                                            BorderBrush="{DynamicResource NextStageInnerBorder}"
                                            BorderThickness="2"
                                            CornerRadius="12"
                                            Padding="24"
                                            MinHeight="120"
                                            Margin="0,0,8,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center" Spacing="8">
                                            <!-- Vue: .next-stage-value — 32px, 700, #4B7C5A/#5FAF78 -->
                                            <TextBlock Text="{Binding CountdownDays}"
                                                       FontSize="32" FontWeight="Bold"
                                                       Foreground="{DynamicResource NextStageValue}"
                                                       HorizontalAlignment="Center" />
                                            <!-- Vue: .next-stage-label — 14px, 500 -->
                                            <TextBlock Text="days"
                                                       FontSize="14" FontWeight="Medium"
                                                       Foreground="{DynamicResource NextStageLabel}"
                                                       HorizontalAlignment="Center" />
                                        </StackPanel>
                                    </Border>

                                    <!-- Hours -->
                                    <Border Background="{DynamicResource NextStageInnerBackground}"
                                            BorderBrush="{DynamicResource NextStageInnerBorder}"
                                            BorderThickness="2"
                                            CornerRadius="12"
                                            Padding="24"
                                            MinHeight="120"
                                            Margin="8,0,8,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center" Spacing="8">
                                            <TextBlock Text="{Binding CountdownHours}"
                                                       FontSize="32" FontWeight="Bold"
                                                       Foreground="{DynamicResource NextStageValue}"
                                                       HorizontalAlignment="Center" />
                                            <TextBlock Text="hours"
                                                       FontSize="14" FontWeight="Medium"
                                                       Foreground="{DynamicResource NextStageLabel}"
                                                       HorizontalAlignment="Center" />
                                        </StackPanel>
                                    </Border>

                                    <!-- Minutes -->
                                    <Border Background="{DynamicResource NextStageInnerBackground}"
                                            BorderBrush="{DynamicResource NextStageInnerBorder}"
                                            BorderThickness="2"
                                            CornerRadius="12"
                                            Padding="24"
                                            MinHeight="120"
                                            Margin="8,0,0,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center" Spacing="8">
                                            <TextBlock Text="{Binding CountdownMins}"
                                                       FontSize="32" FontWeight="Bold"
                                                       Foreground="{DynamicResource NextStageValue}"
                                                       HorizontalAlignment="Center" />
                                            <TextBlock Text="mins"
                                                       FontSize="14" FontWeight="Medium"
                                                       Foreground="{DynamicResource NextStageLabel}"
                                                       HorizontalAlignment="Center" />
                                        </StackPanel>
                                    </Border>
                                </UniformGrid>
                            </StackPanel>
                        </Border>

                        <!-- ── Right: Transaction Statistics ── -->
                        <!-- Vue: .detail-card (generic) -->
                        <Border Grid.Column="2"
                                Background="{DynamicResource DetailCardBg}"
                                BorderBrush="{DynamicResource DetailCardBorder}"
                                BorderThickness="1"
                                CornerRadius="16"
                                Padding="24"
                                BoxShadow="0 2 8 0 #1A000000">
                            <StackPanel Spacing="16">
                                <!-- Header -->
                                <!-- Vue: .card-title — 20px, 700, #1a1a1a (light) / #fafafa (dark) -->
                                <TextBlock Text="Transaction Statistics"
                                           FontSize="20" FontWeight="Bold"
                                           Foreground="{DynamicResource TextStrong}" />

                                <!-- 3-col transaction stats grid -->
                                <!-- Vue: .transaction-stats-grid — repeat(3,1fr), gap 16 -->
                                <UniformGrid Columns="3" Rows="1">
                                    <!-- Total -->
                                    <Border Background="{DynamicResource TransactionStatCardBg}"
                                            BorderBrush="{DynamicResource TransactionStatCardBorder}"
                                            BorderThickness="1"
                                            CornerRadius="12"
                                            Padding="24"
                                            MinHeight="120"
                                            Margin="0,0,8,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center" Spacing="8">
                                            <!-- Vue: .transaction-stat-value — 32px, 700, #1a1a1a/#fafafa -->
                                            <TextBlock Text="{Binding TransactionTotal}"
                                                       FontSize="32" FontWeight="Bold"
                                                       Foreground="{DynamicResource TransactionStatValue}"
                                                       HorizontalAlignment="Center" />
                                            <!-- Vue: .transaction-stat-label — 14px, 500, #6b7280/#9ca3af -->
                                            <TextBlock Text="Total"
                                                       FontSize="14" FontWeight="Medium"
                                                       Foreground="{DynamicResource TransactionStatLabel}"
                                                       HorizontalAlignment="Center" />
                                        </StackPanel>
                                    </Border>

                                    <!-- Spent -->
                                    <Border Background="{DynamicResource TransactionStatCardBg}"
                                            BorderBrush="{DynamicResource TransactionStatCardBorder}"
                                            BorderThickness="1"
                                            CornerRadius="12"
                                            Padding="24"
                                            MinHeight="120"
                                            Margin="8,0,8,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center" Spacing="8">
                                            <TextBlock Text="{Binding TransactionSpent}"
                                                       FontSize="32" FontWeight="Bold"
                                                       Foreground="{DynamicResource TransactionStatValue}"
                                                       HorizontalAlignment="Center" />
                                            <TextBlock Text="Spent"
                                                       FontSize="14" FontWeight="Medium"
                                                       Foreground="{DynamicResource TransactionStatLabel}"
                                                       HorizontalAlignment="Center" />
                                        </StackPanel>
                                    </Border>

                                    <!-- Available -->
                                    <Border Background="{DynamicResource TransactionStatCardBg}"
                                            BorderBrush="{DynamicResource TransactionStatCardBorder}"
                                            BorderThickness="1"
                                            CornerRadius="12"
                                            Padding="24"
                                            MinHeight="120"
                                            Margin="8,0,0,0">
                                        <StackPanel HorizontalAlignment="Center"
                                                    VerticalAlignment="Center" Spacing="8">
                                            <TextBlock Text="{Binding TransactionAvailable}"
                                                       FontSize="32" FontWeight="Bold"
                                                       Foreground="{DynamicResource TransactionStatValue}"
                                                       HorizontalAlignment="Center" />
                                            <TextBlock Text="Available"
                                                       FontSize="14" FontWeight="Medium"
                                                       Foreground="{DynamicResource TransactionStatLabel}"
                                                       HorizontalAlignment="Center" />
                                        </StackPanel>
                                    </Border>
                                </UniformGrid>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <!-- ═══ 4. STAGES SECTION ═══ -->
                    <!-- Vue: .detail-card wrapping the stages list -->
                    <Border Background="{DynamicResource DetailCardBg}"
                            BorderBrush="{DynamicResource DetailCardBorder}"
                            BorderThickness="1"
                            CornerRadius="16"
                            Padding="24"
                            BoxShadow="0 2 8 0 #1A000000">
                        <StackPanel Spacing="0">
                            <!-- Header -->
                            <TextBlock Text="Stages"
                                       FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextStrong}"
                                       Margin="0,0,0,12" />

                            <!-- Instruction text -->
                            <!-- Vue: .stages-instruction — font-size 14, color #6b7280/#9ca3af, mb 20, line-height 1.5 -->
                            <TextBlock Text="Use the Claim button to view and select UTXOs. After selecting UTXOs, click Claim Selected to proceed with claiming them into your Angor wallet."
                                       FontSize="14"
                                       Foreground="{DynamicResource TransactionStatLabel}"
                                       TextWrapping="Wrap"
                                       LineHeight="21"
                                       Margin="0,0,0,20" />

                            <!-- Stage cards list -->
                            <ItemsControl Name="StagesItemsControl" ItemsSource="{Binding Stages}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="mp:ManageStageViewModel">
                                        <!-- Vue: .stage-card — bg #f9f9f9/#0A0A0A, rounded 12, pad 16, border 1px, mb 16 -->
                                        <Border Background="{DynamicResource StageCardBg}"
                                                BorderBrush="{DynamicResource StageCardBorder}"
                                                BorderThickness="1"
                                                CornerRadius="12"
                                                Padding="16"
                                                Margin="0,0,0,16">
                                            <StackPanel Spacing="0">
                                                <!-- Stage card header -->
                                                <!-- Vue: .stage-card-header — flex between, mb 12, pb 12, border-bottom -->
                                                <Border BorderBrush="{DynamicResource StageCardHeaderBorder}"
                                                        BorderThickness="0,0,0,1"
                                                        Padding="0,0,0,12"
                                                        Margin="0,0,0,12">
                                                    <Grid ColumnDefinitions="*,Auto">
                                                        <!-- Left: Stage number + pills -->
                                                        <!-- Vue: .stage-header-left — gap 12 -->
                                                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12"
                                                                    VerticalAlignment="Center">
                                                            <!-- Vue: .stage-number — 16px, 600, #1a1a1a/#fafafa -->
                                                            <TextBlock Text="{Binding Number, StringFormat=Stage {0}}"
                                                                       FontSize="16" FontWeight="SemiBold"
                                                                       Foreground="{DynamicResource StageCardNumber}"
                                                                       VerticalAlignment="Center" />

                                                            <!-- Pills -->
                                                            <!-- Vue: .stage-pills — gap 8 -->
                                                            <StackPanel Orientation="Horizontal" Spacing="8"
                                                                        VerticalAlignment="Center">
                                                                <!-- BTC pill -->
                                                                <!-- Vue: .stage-pill — pad 4 12, rounded 16, font 12px 600 -->
                                                                <Border Background="{DynamicResource StagePillBg}"
                                                                        BorderBrush="{DynamicResource StagePillBorder}"
                                                                        BorderThickness="1"
                                                                        CornerRadius="16"
                                                                        Padding="12,4">
                                                                    <TextBlock Text="{Binding AmountLeft, StringFormat={}{0} BTC}"
                                                                               FontSize="12" FontWeight="SemiBold"
                                                                               Foreground="{DynamicResource StagePillText}" />
                                                                </Border>

                                                                <!-- UTXO count pill -->
                                                                <Border Background="{DynamicResource StagePillBg}"
                                                                        BorderBrush="{DynamicResource StagePillBorder}"
                                                                        BorderThickness="1"
                                                                        CornerRadius="16"
                                                                        Padding="12,4">
                                                                    <TextBlock Text="{Binding UtxoCount, StringFormat={}{0} utxo}"
                                                                               FontSize="12" FontWeight="SemiBold"
                                                                               Foreground="{DynamicResource StagePillText}" />
                                                                </Border>
                                                            </StackPanel>
                                                        </StackPanel>

                                                        <!-- Right: status badges -->
                                                        <!-- Vue: .stage-header-right — gap 12 -->
                                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="12"
                                                                    VerticalAlignment="Center">
                                                            <!-- "Spent by founder" badge (when fully spent) -->
                                                            <!-- Vue: .spent-by-founder-button — pad 8 16, rounded 6, color #f59e0b, border 1px #f59e0b -->
                                                            <Border IsVisible="{Binding IsFullySpent}"
                                                                    Background="Transparent"
                                                                    BorderBrush="#F59E0B"
                                                                    BorderThickness="1"
                                                                    CornerRadius="6"
                                                                    Padding="16,8">
                                                                <TextBlock Text="Spent by founder"
                                                                           FontSize="13" FontWeight="SemiBold"
                                                                           Foreground="#F59E0B" />
                                                            </Border>

                                                            <!-- "Funds Available" badge (when has unspent txs) -->
                                                            <!-- Vue: .fund-available-button — pad 8 16, rounded 6, color #4B7C5A, border 1px #4B7C5A -->
                                                            <Border IsVisible="{Binding HasUnspentTransactions}"
                                                                    Background="Transparent"
                                                                    BorderBrush="#4B7C5A"
                                                                    BorderThickness="1"
                                                                    CornerRadius="6"
                                                                    Padding="16,8">
                                                                <TextBlock Text="Funds Available"
                                                                           FontSize="13" FontWeight="SemiBold"
                                                                           Foreground="#4B7C5A" />
                                                            </Border>
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>

                                                <!-- Stage card body -->
                                                <!-- Vue: .stage-card-body — flex column, gap 10 -->
                                                <StackPanel Spacing="10">
                                                    <!-- Vue: .stage-card-item — .stage-card-label + .stage-card-value inline -->
                                                    <StackPanel Orientation="Horizontal">
                                                        <!-- Vue: .stage-card-label — 13px, #666/#a0a0a0, 500 -->
                                                        <TextBlock Text="Estimated completion: "
                                                                   FontSize="13" FontWeight="Medium"
                                                                   Foreground="{DynamicResource StageCardLabel}" />
                                                        <!-- Vue: .stage-card-value — 13px, #333/#fafafa, 600 -->
                                                        <TextBlock Text="{Binding CompletionDate}"
                                                                   FontSize="13" FontWeight="SemiBold"
                                                                   Foreground="{DynamicResource StageCardValue}" />
                                                    </StackPanel>
                                                </StackPanel>

                                                <!-- Action Buttons -->
                                                <!-- Vue: flex gap-3 mt-4 -->
                                                <StackPanel Orientation="Horizontal" Spacing="12"
                                                            Margin="0,16,0,0">
                                                    <!-- Claim button (available && canClaim) -->
                                                    <!-- Vue: .claim-button — green gradient, white text, rounded 8, pad 12 16, full width -->
                                                    <Button Classes="StageClaimBtn"
                                                            IsVisible="{Binding CanClaim}"
                                                            Tag="{Binding Number}"
                                                            HorizontalAlignment="Stretch"
                                                            HorizontalContentAlignment="Center"
                                                            Padding="16,12"
                                                            CornerRadius="8"
                                                            BorderThickness="0"
                                                            FontWeight="SemiBold"
                                                            FontSize="14"
                                                            Foreground="White">
                                                        <Button.Background>
                                                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                                                <GradientStop Color="#4B7C5A" Offset="0" />
                                                                <GradientStop Color="#3D6448" Offset="1" />
                                                            </LinearGradientBrush>
                                                        </Button.Background>
                                                        <TextBlock Text="Claim" FontWeight="SemiBold" />
                                                    </Button>

                                                    <!-- Spent button (fully spent) -->
                                                    <!-- Vue: .spent-button — border 2px #f59e0b, color #f59e0b, opacity 0.5, transparent bg -->
                                                    <Button Classes="StageSpentBtn"
                                                            IsVisible="{Binding IsFullySpent}"
                                                            Tag="{Binding Number}"
                                                            HorizontalAlignment="Stretch"
                                                            HorizontalContentAlignment="Center"
                                                            Padding="24,12"
                                                            CornerRadius="8"
                                                            Background="Transparent"
                                                            BorderBrush="#F59E0B"
                                                            BorderThickness="2"
                                                            Foreground="#F59E0B"
                                                            FontSize="14" FontWeight="SemiBold"
                                                            Opacity="0.5">
                                                        <TextBlock Text="Spent" FontWeight="SemiBold" />
                                                    </Button>

                                                    <!-- Available in X Days button (available && !canClaim && !fullySpent) -->
                                                    <!-- Vue: rendered as claim-button but with disabled styling or "Available in X Days" text -->
                                                    <Button IsVisible="{Binding ShowAvailableInDays}"
                                                            HorizontalAlignment="Stretch"
                                                            HorizontalContentAlignment="Center"
                                                            Padding="16,12"
                                                            CornerRadius="8"
                                                            Background="{DynamicResource ClaimDisabledBg}"
                                                            BorderBrush="{DynamicResource ClaimDisabledBorder}"
                                                            BorderThickness="2"
                                                            Foreground="{DynamicResource ClaimDisabledText}"
                                                            FontSize="14" FontWeight="SemiBold">
                                                        <TextBlock Text="{Binding AvailableInDaysText}" FontWeight="SemiBold" />
                                                    </Button>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Panel>
        </ScrollViewer>

        <!-- ═══════════════════════════════════════════════════════════════════════
             MODAL OVERLAYS — stacked above all content (ZIndex 200+)
             Vue ref: ManageFunds.vue — 7 modals in sequence.
             Pattern: semi-transparent backdrop + centered card.
             ═══════════════════════════════════════════════════════════════════════ -->

        <!-- ═══ MODAL 1: SELECT UTXOs TO CLAIM (max-w-2xl = 672px) ═══ -->
        <!-- Vue: showClaimModal — .rounded-2xl, bg-white / bg-[#1a1a1a] border-[#404040] -->
        <Panel Name="ClaimModalOverlay"
               IsVisible="{Binding ShowClaimModal}"
               ZIndex="200"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="672" Width="672"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource DetailCardBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    ClipToBounds="True">
                <StackPanel>
                    <!-- Header: p-6 border-b -->
                    <Border Padding="24"
                            BorderBrush="{DynamicResource ModalHeaderBorder}"
                            BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0"
                                       Text="Select UTXOs to Claim"
                                       FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextStrong}"
                                       VerticalAlignment="Center" />
                            <!-- Close X button -->
                            <Button Name="ClaimModalCloseBtn" Grid.Column="1"
                                    Background="Transparent" BorderThickness="0"
                                    Padding="8" CornerRadius="8" Cursor="Hand">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="{StaticResource XMark}"
                                          Stroke="{DynamicResource ModalCloseBtn}"
                                          StrokeThickness="2"
                                          StrokeLineCap="Round" StrokeJoin="Round"
                                          Width="24" Height="24" Stretch="Uniform" />
                                </Viewbox>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Body: p-6 -->
                    <StackPanel Margin="24" Spacing="16">
                        <!-- Description text -->
                        <TextBlock Text="Select the UTXOs you want to claim. After selecting, click Claim to proceed."
                                   FontSize="14"
                                   Foreground="{DynamicResource ModalDescriptionText}"
                                   TextWrapping="Wrap" />

                        <!-- UTXO items list (scrollable) -->
                        <ScrollViewer MaxHeight="384" VerticalScrollBarVisibility="Auto">
                            <ItemsControl Name="ClaimUtxoList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="mp:UtxoTransactionViewModel">
                                        <!-- Vue: .available-transaction-item — bg green-50, border green-300, rounded 8, pad 12 16 -->
                                        <Border Background="{DynamicResource UtxoItemBg}"
                                                BorderBrush="{DynamicResource UtxoItemBorder}"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="16,12"
                                                Margin="0,0,0,12"
                                                Cursor="Hand"
                                                Name="UtxoItemBorder">
                                            <Grid ColumnDefinitions="*,Auto">
                                                <!-- Left: amount + txid -->
                                                <StackPanel Grid.Column="0" Spacing="4">
                                                    <TextBlock Text="{Binding Amount, StringFormat={}{0} BTC}"
                                                               FontSize="14" FontWeight="SemiBold"
                                                               Foreground="{DynamicResource TextStrong}" />
                                                    <TextBlock Text="{Binding TxId}"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource UtxoTxidText}"
                                                               FontFamily="Courier New, monospace"
                                                               TextWrapping="Wrap" />
                                                </StackPanel>
                                                <!-- Right: checkbox toggle -->
                                                <!-- Vue: .settings-toggle-button 24x24, border 2px -->
                                                <Border Grid.Column="1"
                                                        Width="24" Height="24"
                                                        CornerRadius="4"
                                                        BorderThickness="2"
                                                        VerticalAlignment="Center"
                                                        HorizontalAlignment="Center"
                                                        Background="{DynamicResource ToggleCheckBg}"
                                                        BorderBrush="{DynamicResource ToggleCheckBorder}"
                                                        Name="UtxoCheckbox">
                                                    <!-- Checkmark visible when selected -->
                                                    <Viewbox Width="14" Height="14"
                                                             IsVisible="{Binding IsSelected}"
                                                             HorizontalAlignment="Center"
                                                             VerticalAlignment="Center">
                                                        <Path Data="{StaticResource Checkmark}"
                                                              Stroke="White"
                                                              StrokeThickness="2"
                                                              StrokeLineCap="Round" StrokeJoin="Round"
                                                              Width="24" Height="24" Stretch="Uniform" />
                                                    </Viewbox>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Action Buttons: Cancel + Claim Selected -->
                        <Grid ColumnDefinitions="*,12,*">
                            <!-- Cancel -->
                            <Button Name="ClaimModalCancelBtn" Grid.Column="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    Background="Transparent"
                                    BorderBrush="{DynamicResource ModalCancelBtnBorder}"
                                    BorderThickness="2"
                                    Foreground="{DynamicResource ModalCancelBtnText}"
                                    FontSize="16" FontWeight="SemiBold">
                                <TextBlock Text="Cancel" FontWeight="SemiBold" />
                            </Button>
                            <!-- Claim Selected -->
                            <Button Name="ClaimSelectedBtn" Grid.Column="2"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    BorderThickness="0"
                                    Foreground="White"
                                    FontSize="16" FontWeight="SemiBold">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                        <GradientStop Color="#4B7C5A" Offset="0" />
                                        <GradientStop Color="#3D6448" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <TextBlock Text="Claim Selected" FontWeight="SemiBold" />
                            </Button>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Panel>

        <!-- ═══ MODAL 2: CONFIRM CLAIM (Password) (max-w-md = 448px) ═══ -->
        <!-- Vue: showPasswordModal — Confirm Claim, password input -->
        <Panel Name="PasswordModalOverlay"
               IsVisible="{Binding ShowPasswordModal}"
               ZIndex="201"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="448" Width="448"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource DetailCardBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    ClipToBounds="True">
                <StackPanel>
                    <!-- Header -->
                    <Border Padding="24"
                            BorderBrush="{DynamicResource ModalHeaderBorder}"
                            BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0"
                                       Text="Confirm Claim"
                                       FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextStrong}"
                                       VerticalAlignment="Center" />
                            <Button Name="PasswordModalCloseBtn" Grid.Column="1"
                                    Background="Transparent" BorderThickness="0"
                                    Padding="8" CornerRadius="8" Cursor="Hand">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="{StaticResource XMark}"
                                          Stroke="{DynamicResource ModalCloseBtn}"
                                          StrokeThickness="2"
                                          StrokeLineCap="Round" StrokeJoin="Round"
                                          Width="24" Height="24" Stretch="Uniform" />
                                </Viewbox>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Body -->
                    <StackPanel Margin="24" Spacing="16">
                        <TextBlock Text="Please enter your wallet password to confirm claiming funds into your Angor wallet."
                                   FontSize="14"
                                   Foreground="{DynamicResource ModalDescriptionText}"
                                   TextWrapping="Wrap" />

                        <!-- Password Input -->
                        <!-- Vue: px-4 py-3 rounded-lg border, bg white/#0A0A0A, border gray-300/#404040 -->
                        <TextBox Name="ClaimPasswordInput"
                                 PasswordChar="*"
                                 Watermark="Enter wallet password"
                                 Padding="16,12"
                                 CornerRadius="8"
                                 Background="{DynamicResource ModalInputBg}"
                                 BorderBrush="{DynamicResource ModalInputBorder}"
                                 BorderThickness="1"
                                 FontSize="14"
                                 Foreground="{DynamicResource TextStrong}" />

                        <!-- Action Buttons -->
                        <Grid ColumnDefinitions="*,12,*">
                            <Button Name="PasswordModalCancelBtn" Grid.Column="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    Background="Transparent"
                                    BorderBrush="{DynamicResource ModalCancelBtnBorder}"
                                    BorderThickness="2"
                                    Foreground="{DynamicResource ModalCancelBtnText}"
                                    FontSize="16" FontWeight="SemiBold">
                                <TextBlock Text="Cancel" FontWeight="SemiBold" />
                            </Button>
                            <Button Name="ConfirmClaimBtn" Grid.Column="2"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    BorderThickness="0"
                                    Foreground="White"
                                    FontSize="16" FontWeight="SemiBold">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                        <GradientStop Color="#4B7C5A" Offset="0" />
                                        <GradientStop Color="#3D6448" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <!-- Spinner (visible when claiming) -->
                                    <Viewbox Width="16" Height="16"
                                             IsVisible="{Binding IsClaiming}">
                                        <Path Data="{StaticResource RefreshArrows}"
                                              Stroke="White"
                                              StrokeThickness="2"
                                              StrokeLineCap="Round" StrokeJoin="Round"
                                              Width="24" Height="24" Stretch="Uniform" />
                                    </Viewbox>
                                    <TextBlock Name="ConfirmClaimText"
                                               Text="Confirm"
                                               FontWeight="SemiBold" />
                                </StackPanel>
                            </Button>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Panel>

        <!-- ═══ MODAL 3: CLAIM SUCCESS (max-w-md = 448px) ═══ -->
        <!-- Vue: showSuccessModal — bg-[#2A2A2A] (dark), p-8, green circle icon -->
        <Panel Name="SuccessModalOverlay"
               IsVisible="{Binding ShowSuccessModal}"
               ZIndex="202"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="448" Width="448"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource SuccessModalBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    Padding="32">
                <StackPanel Spacing="24">
                    <!-- Success Icon: 80x80 green circle with checkmark -->
                    <!-- Vue: w-20 h-20, bg rgba(75,124,90,0.1/0.2), checkmark #4B7C5A -->
                    <Border Width="80" Height="80" CornerRadius="40"
                            Background="{DynamicResource SuccessIconCircleBg}"
                            HorizontalAlignment="Center">
                        <Viewbox Width="48" Height="48"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center">
                            <Path Data="{StaticResource Checkmark}"
                                  Stroke="#4B7C5A"
                                  StrokeThickness="2"
                                  StrokeLineCap="Round" StrokeJoin="Round"
                                  Width="24" Height="24" Stretch="Uniform" />
                        </Viewbox>
                    </Border>

                    <!-- Title: "Funds Claimed!" -->
                    <TextBlock Text="Funds Claimed!"
                               FontSize="30" FontWeight="Bold"
                               Foreground="{DynamicResource TextStrong}"
                               HorizontalAlignment="Center" />

                    <!-- Message -->
                    <TextBlock HorizontalAlignment="Center"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               FontSize="16"
                               Foreground="{DynamicResource ModalDescriptionText}">
                        <Run Text="Successfully claimed " />
                        <Run Text="{Binding ClaimedAmount, StringFormat={}{0} BTC, Mode=OneWay}" FontWeight="SemiBold" />
                        <Run Text=" into your Angor Account Bitcoin wallet." />
                    </TextBlock>

                    <!-- Buttons stacked vertically: Go to Funds + Close -->
                    <StackPanel Spacing="12">
                        <!-- Go to Funds (green gradient) -->
                        <Button Name="GoToFundsBtn"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                Padding="24,12"
                                CornerRadius="8"
                                BorderThickness="0"
                                Foreground="White"
                                FontSize="16" FontWeight="SemiBold">
                            <Button.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Color="#4B7C5A" Offset="0" />
                                    <GradientStop Color="#3D6448" Offset="1" />
                                </LinearGradientBrush>
                            </Button.Background>
                            <TextBlock Text="Go to Funds" FontWeight="SemiBold" />
                        </Button>
                        <!-- Close (border) -->
                        <Button Name="SuccessCloseBtn"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                Padding="24,12"
                                CornerRadius="8"
                                Background="Transparent"
                                BorderBrush="{DynamicResource ModalCancelBtnBorder}"
                                BorderThickness="2"
                                Foreground="{DynamicResource ModalCancelBtnText}"
                                FontSize="16" FontWeight="SemiBold">
                            <TextBlock Text="Close" FontWeight="SemiBold" />
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Panel>

        <!-- ═══ MODAL 4: RELEASE FUNDS TO INVESTORS (max-w-2xl = 672px) ═══ -->
        <!-- Vue: showReleaseFundsModal — pre-selected UTXOs with opacity, disabled checkboxes -->
        <Panel Name="ReleaseFundsModalOverlay"
               IsVisible="{Binding ShowReleaseFundsModal}"
               ZIndex="200"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="672" Width="672"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource DetailCardBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    ClipToBounds="True">
                <StackPanel>
                    <!-- Header -->
                    <Border Padding="24"
                            BorderBrush="{DynamicResource ModalHeaderBorder}"
                            BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0"
                                       Text="Release Funds Back to Investors"
                                       FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextStrong}"
                                       VerticalAlignment="Center" />
                            <Button Name="ReleaseFundsModalCloseBtn" Grid.Column="1"
                                    Background="Transparent" BorderThickness="0"
                                    Padding="8" CornerRadius="8" Cursor="Hand">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="{StaticResource XMark}"
                                          Stroke="{DynamicResource ModalCloseBtn}"
                                          StrokeThickness="2"
                                          StrokeLineCap="Round" StrokeJoin="Round"
                                          Width="24" Height="24" Stretch="Uniform" />
                                </Viewbox>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Body -->
                    <StackPanel Margin="24" Spacing="16">
                        <!-- UTXO items (pre-selected, opacity 0.75, disabled checkboxes) -->
                        <ScrollViewer MaxHeight="384" VerticalScrollBarVisibility="Auto">
                            <ItemsControl Name="ReleaseUtxoList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="mp:UtxoTransactionViewModel">
                                        <!-- Vue: opacity-75, border-[#4B7C5A], cursor-not-allowed -->
                                        <Border Background="{DynamicResource ReleaseUtxoItemBg}"
                                                BorderBrush="{DynamicResource ReleaseUtxoItemBorder}"
                                                BorderThickness="2"
                                                CornerRadius="8"
                                                Padding="16,12"
                                                Margin="0,0,0,12"
                                                Opacity="0.75">
                                            <Grid ColumnDefinitions="*,Auto">
                                                <StackPanel Grid.Column="0" Spacing="4">
                                                    <TextBlock Text="{Binding Amount, StringFormat={}{0} BTC}"
                                                               FontSize="14" FontWeight="SemiBold"
                                                               Foreground="{DynamicResource TextStrong}" />
                                                    <TextBlock Text="{Binding TxId}"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource UtxoTxidText}"
                                                               FontFamily="Courier New, monospace"
                                                               TextWrapping="Wrap" />
                                                </StackPanel>
                                                <!-- Disabled checkbox (always checked, green bg/border) -->
                                                <Border Grid.Column="1"
                                                        Width="24" Height="24"
                                                        CornerRadius="4"
                                                        BorderThickness="2"
                                                        VerticalAlignment="Center"
                                                        Background="#4B7C5A"
                                                        BorderBrush="#4B7C5A">
                                                    <Viewbox Width="14" Height="14"
                                                             HorizontalAlignment="Center"
                                                             VerticalAlignment="Center">
                                                        <Path Data="{StaticResource Checkmark}"
                                                              Stroke="White"
                                                              StrokeThickness="2"
                                                              StrokeLineCap="Round" StrokeJoin="Round"
                                                              Width="24" Height="24" Stretch="Uniform" />
                                                    </Viewbox>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Action Buttons: Cancel + Release Funds -->
                        <Grid ColumnDefinitions="*,12,*">
                            <Button Name="ReleaseFundsCancelBtn" Grid.Column="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    Background="Transparent"
                                    BorderBrush="{DynamicResource ModalCancelBtnBorder}"
                                    BorderThickness="2"
                                    Foreground="{DynamicResource ModalCancelBtnText}"
                                    FontSize="16" FontWeight="SemiBold">
                                <TextBlock Text="Cancel" FontWeight="SemiBold" />
                            </Button>
                            <Button Name="ReleaseFundsConfirmBtn" Grid.Column="2"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    BorderThickness="0"
                                    Foreground="White"
                                    FontSize="16" FontWeight="SemiBold">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                        <GradientStop Color="#4B7C5A" Offset="0" />
                                        <GradientStop Color="#3D6448" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <TextBlock Text="Release Funds" FontWeight="SemiBold" />
                            </Button>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Panel>

        <!-- ═══ MODAL 5: CONFIRM RELEASE (Password) (max-w-md = 448px) ═══ -->
        <!-- Vue: showReleaseFundsPasswordModal — same as claim password but "Confirm Release" -->
        <Panel Name="ReleasePasswordModalOverlay"
               IsVisible="{Binding ShowReleaseFundsPasswordModal}"
               ZIndex="201"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="448" Width="448"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource DetailCardBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    ClipToBounds="True">
                <StackPanel>
                    <!-- Header -->
                    <Border Padding="24"
                            BorderBrush="{DynamicResource ModalHeaderBorder}"
                            BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0"
                                       Text="Confirm Release"
                                       FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextStrong}"
                                       VerticalAlignment="Center" />
                            <Button Name="ReleasePasswordModalCloseBtn" Grid.Column="1"
                                    Background="Transparent" BorderThickness="0"
                                    Padding="8" CornerRadius="8" Cursor="Hand">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="{StaticResource XMark}"
                                          Stroke="{DynamicResource ModalCloseBtn}"
                                          StrokeThickness="2"
                                          StrokeLineCap="Round" StrokeJoin="Round"
                                          Width="24" Height="24" Stretch="Uniform" />
                                </Viewbox>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Body -->
                    <StackPanel Margin="24" Spacing="16">
                        <TextBlock Text="Please enter your wallet password to confirm releasing funds back to investors."
                                   FontSize="14"
                                   Foreground="{DynamicResource ModalDescriptionText}"
                                   TextWrapping="Wrap" />

                        <TextBox Name="ReleasePasswordInput"
                                 PasswordChar="*"
                                 Watermark="Enter wallet password"
                                 Padding="16,12"
                                 CornerRadius="8"
                                 Background="{DynamicResource ModalInputBg}"
                                 BorderBrush="{DynamicResource ModalInputBorder}"
                                 BorderThickness="1"
                                 FontSize="14"
                                 Foreground="{DynamicResource TextStrong}" />

                        <Grid ColumnDefinitions="*,12,*">
                            <Button Name="ReleasePasswordCancelBtn" Grid.Column="0"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    Background="Transparent"
                                    BorderBrush="{DynamicResource ModalCancelBtnBorder}"
                                    BorderThickness="2"
                                    Foreground="{DynamicResource ModalCancelBtnText}"
                                    FontSize="16" FontWeight="SemiBold">
                                <TextBlock Text="Cancel" FontWeight="SemiBold" />
                            </Button>
                            <Button Name="ConfirmReleaseBtn" Grid.Column="2"
                                    HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center"
                                    Padding="24,12"
                                    CornerRadius="8"
                                    BorderThickness="0"
                                    Foreground="White"
                                    FontSize="16" FontWeight="SemiBold">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                        <GradientStop Color="#4B7C5A" Offset="0" />
                                        <GradientStop Color="#3D6448" Offset="1" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                                    <Viewbox Width="16" Height="16"
                                             IsVisible="{Binding IsReleasingFunds}">
                                        <Path Data="{StaticResource RefreshArrows}"
                                              Stroke="White"
                                              StrokeThickness="2"
                                              StrokeLineCap="Round" StrokeJoin="Round"
                                              Width="24" Height="24" Stretch="Uniform" />
                                    </Viewbox>
                                    <TextBlock Name="ConfirmReleaseText"
                                               Text="Confirm"
                                               FontWeight="SemiBold" />
                                </StackPanel>
                            </Button>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Panel>

        <!-- ═══ MODAL 6: RELEASE SUCCESS (max-w-md = 448px) ═══ -->
        <!-- Vue: showReleaseFundsSuccessModal — 64x64 green gradient circle, "Funds Returned" -->
        <Panel Name="ReleaseSuccessModalOverlay"
               IsVisible="{Binding ShowReleaseFundsSuccessModal}"
               ZIndex="202"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="448" Width="448"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource DetailCardBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    Padding="32">
                <StackPanel Spacing="16">
                    <!-- Success Icon: 64x64 green gradient circle (NOT bg circle, gradient fill) -->
                    <!-- Vue: w-16 h-16, style="background: linear-gradient(135deg, #4B7C5A, #3d6448)" -->
                    <Border Width="64" Height="64" CornerRadius="32"
                            HorizontalAlignment="Center">
                        <Border.Background>
                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                <GradientStop Color="#4B7C5A" Offset="0" />
                                <GradientStop Color="#3D6448" Offset="1" />
                            </LinearGradientBrush>
                        </Border.Background>
                        <Viewbox Width="32" Height="32"
                                 HorizontalAlignment="Center"
                                 VerticalAlignment="Center">
                            <Path Data="{StaticResource Checkmark}"
                                  Stroke="White"
                                  StrokeThickness="2"
                                  StrokeLineCap="Round" StrokeJoin="Round"
                                  Width="24" Height="24" Stretch="Uniform" />
                        </Viewbox>
                    </Border>

                    <!-- Title -->
                    <TextBlock Text="Funds Returned"
                               FontSize="24" FontWeight="Bold"
                               Foreground="{DynamicResource TextStrong}"
                               HorizontalAlignment="Center"
                               Margin="0,8,0,0" />

                    <!-- Message -->
                    <TextBlock HorizontalAlignment="Center"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               FontSize="16"
                               Foreground="{DynamicResource ModalDescriptionText}">
                        <Run Text="{Binding ReleasedAmount, StringFormat={}{0} BTC, Mode=OneWay}" FontWeight="SemiBold" />
                        <Run Text=" has been successfully returned to investors." />
                    </TextBlock>

                    <!-- Done button (green gradient, full width) -->
                    <Button Name="ReleaseDoneBtn"
                            HorizontalAlignment="Stretch"
                            HorizontalContentAlignment="Center"
                            Padding="24,12"
                            CornerRadius="8"
                            BorderThickness="0"
                            Foreground="White"
                            FontSize="16" FontWeight="SemiBold"
                            Margin="0,8,0,0">
                        <Button.Background>
                            <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                <GradientStop Color="#4B7C5A" Offset="0" />
                                <GradientStop Color="#3D6448" Offset="1" />
                            </LinearGradientBrush>
                        </Button.Background>
                        <TextBlock Text="Done" FontWeight="SemiBold" />
                    </Button>
                </StackPanel>
            </Border>
        </Panel>

        <!-- ═══ MODAL 7: SPENT UTXOs (max-w-2xl = 672px) ═══ -->
        <!-- Vue: showSpentModal — spent transaction items with amber "Spent" label -->
        <Panel Name="SpentModalOverlay"
               IsVisible="{Binding ShowSpentModal}"
               ZIndex="200"
               Background="{DynamicResource ModalBackdrop}">
            <Border MaxWidth="672" Width="672"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="{DynamicResource DetailCardBg}"
                    BorderBrush="{DynamicResource ModalHeaderBorder}"
                    BorderThickness="1"
                    CornerRadius="16"
                    BoxShadow="0 8 32 0 #40000000"
                    ClipToBounds="True">
                <StackPanel>
                    <!-- Header -->
                    <Border Padding="24"
                            BorderBrush="{DynamicResource ModalHeaderBorder}"
                            BorderThickness="0,0,0,1">
                        <Grid ColumnDefinitions="*,Auto">
                            <TextBlock Grid.Column="0"
                                       Text="Spent UTXOs"
                                       FontSize="20" FontWeight="Bold"
                                       Foreground="{DynamicResource TextStrong}"
                                       VerticalAlignment="Center" />
                            <Button Name="SpentModalCloseBtn" Grid.Column="1"
                                    Background="Transparent" BorderThickness="0"
                                    Padding="8" CornerRadius="8" Cursor="Hand">
                                <Viewbox Width="20" Height="20">
                                    <Path Data="{StaticResource XMark}"
                                          Stroke="{DynamicResource ModalCloseBtn}"
                                          StrokeThickness="2"
                                          StrokeLineCap="Round" StrokeJoin="Round"
                                          Width="24" Height="24" Stretch="Uniform" />
                                </Viewbox>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Body -->
                    <StackPanel Margin="24" Spacing="16">
                        <TextBlock Text="These UTXOs have been spent by the founder."
                                   FontSize="14"
                                   Foreground="{DynamicResource ModalDescriptionText}"
                                   TextWrapping="Wrap" />

                        <!-- Spent UTXO items -->
                        <ScrollViewer MaxHeight="384" VerticalScrollBarVisibility="Auto">
                            <ItemsControl Name="SpentUtxoList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate x:DataType="mp:UtxoTransactionViewModel">
                                        <!-- Vue: .spent-transaction-item — bg #f9fafb/#1a1a1a, border #e0e7ff/#404040 -->
                                        <Border Background="{DynamicResource SpentItemBg}"
                                                BorderBrush="{DynamicResource SpentItemBorder}"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="16,12"
                                                Margin="0,0,0,12">
                                            <Grid ColumnDefinitions="*,Auto">
                                                <StackPanel Grid.Column="0" Spacing="4">
                                                    <TextBlock Text="{Binding Amount, StringFormat={}{0} BTC}"
                                                               FontSize="14" FontWeight="SemiBold"
                                                               Foreground="{DynamicResource TextStrong}" />
                                                    <TextBlock Text="{Binding TxId}"
                                                               FontSize="12"
                                                               Foreground="{DynamicResource UtxoTxidText}"
                                                               FontFamily="Courier New, monospace"
                                                               TextWrapping="Wrap" />
                                                </StackPanel>
                                                <!-- Spent badge (amber) -->
                                                <!-- Vue: text-xs, bg-amber-100/bg-amber-900 bg-opacity-30, text-amber-700/text-amber-300, opacity-60 -->
                                                <Border Grid.Column="1"
                                                        Background="#FEF3C7"
                                                        CornerRadius="4"
                                                        Padding="8,2"
                                                        VerticalAlignment="Center"
                                                        Opacity="0.6">
                                                    <TextBlock Text="Spent"
                                                               FontSize="12" FontWeight="Normal"
                                                               Foreground="#92400E" />
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- Close button (green gradient, full width) -->
                        <Button Name="SpentModalDoneBtn"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                Padding="24,12"
                                CornerRadius="8"
                                BorderThickness="0"
                                Foreground="White"
                                FontSize="16" FontWeight="SemiBold">
                            <Button.Background>
                                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                    <GradientStop Color="#4B7C5A" Offset="0" />
                                    <GradientStop Color="#3D6448" Offset="1" />
                                </LinearGradientBrush>
                            </Button.Background>
                            <TextBlock Text="Close" FontWeight="SemiBold" />
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Panel>
    </Panel>
</UserControl>
