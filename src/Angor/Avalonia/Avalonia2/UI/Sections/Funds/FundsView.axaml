<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:funds="clr-namespace:Avalonia2.UI.Sections.Funds"
             xmlns:controls="clr-namespace:Avalonia2.UI.Shared.Controls"
             xmlns:i="https://github.com/projektanker/icons.avalonia"
             mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="800"
             x:Class="Avalonia2.UI.Sections.Funds.FundsView"
             x:DataType="funds:FundsViewModel">
    <Design.DataContext>
        <funds:FundsViewModel />
    </Design.DataContext>

    <Panel>
        <!-- ═══ EMPTY STATE (no wallets) ═══ -->
        <!--
            Vue (Funds.vue, walletGroups.length === 0):
            Centered layout, Angor logo w-28 h-28, "FUNDS" title,
            "Wallet's get created when you fund or launch projects..." description,
            "Add Wallet" button (btn-primary, with + icon)
        -->
        <Panel Name="EmptyStatePanel" IsVisible="{Binding !HasWallets}">
            <controls:EmptyState Title="FUNDS"
                                 Description="Wallet's get created when you fund or launch projects, but if you want to import or create one before please do"
                                 ButtonText="Add Wallet"
                                 HasButton="True"
                                 ButtonIconValue="fa-solid fa-plus" />
        </Panel>

        <!-- ═══ POPULATED STATE (has wallets) ═══ -->
        <!--
            Vue: Single-column full-width scrollable view, max-width 1200px.
            Vertical stack: Balance Summary card → Wallet Groups → Add Wallet button.
        -->
        <Panel Name="PopulatedPanel" IsVisible="{Binding HasWallets}">
            <controls:ScrollableView ContentPadding="24,24,24,24">
                <StackPanel Spacing="24" MaxWidth="1200" HorizontalAlignment="Stretch">

                    <!-- ═══ Balance Summary Card ═══ -->
                    <!--
                        Vue: .funds-summary-card .stats-detail-card
                        Light: bg linear-gradient(to bottom right, #fff7ed, #fef3c7), border #fed7aa
                        Dark: bg linear-gradient(to br, rgba(234,88,12,0.15), rgba(251,191,36,0.15)), border rgba(234,88,12,0.3)
                        border-radius: 16px, padding: 24px, shadow: 0 2px 8px rgba(0,0,0,0.1)
                    -->
                    <Border Background="{DynamicResource StatsDetailCardBackground}"
                            BorderBrush="{DynamicResource StatsDetailCardBorder}"
                            BorderThickness="1"
                            CornerRadius="16"
                            Padding="24"
                            BoxShadow="{DynamicResource ItemShadow}">
                        <StackPanel Spacing="20">
                            <!-- Header: Bitcoin icon + "Balance Summary" -->
                            <StackPanel Orientation="Horizontal" Spacing="12">
                                <!-- Bitcoin circle icon: 40x40, gradient #F7931A→#FFA500, shadow -->
                                <Border Width="40" Height="40" CornerRadius="20"
                                        ClipToBounds="True">
                                    <Border.Background>
                                        <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                            <GradientStop Color="#F7931A" Offset="0" />
                                            <GradientStop Color="#FFA500" Offset="1" />
                                        </LinearGradientBrush>
                                    </Border.Background>
                                    <i:Icon Value="fa-brands fa-bitcoin"
                                           FontSize="20"
                                           Foreground="White" />
                                </Border>
                                <TextBlock Text="Balance Summary"
                                           FontSize="20" FontWeight="Bold"
                                           Foreground="{DynamicResource StatsDetailLabel}"
                                           VerticalAlignment="Center" />
                            </StackPanel>

                            <!-- Stats Grid: 3 stat cards in a row -->
                            <!--
                                Vue: grid-template-columns: repeat(4, 1fr) but only 3 shown.
                                Each stat card: bg rgba(255,255,255,0.7), border 2px solid rgba(253,186,116,0.4),
                                border-radius 12px, padding 20px, backdrop-filter blur(10px)
                            -->
                            <UniformGrid Columns="3" Rows="1">
                                <!-- Total Balance stat card -->
                                <Border Background="{DynamicResource StatsDetailInnerBackground}"
                                        BorderBrush="{DynamicResource StatsDetailInnerBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="0,0,8,0">
                                    <StackPanel Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <Viewbox Width="14" Height="14" VerticalAlignment="Center">
                                                <Path Data="{StaticResource NavIconWallet}"
                                                      Fill="{DynamicResource BitcoinAccent}"
                                                      Opacity="0.7"
                                                      Stretch="Uniform" />
                                            </Viewbox>
                                            <TextBlock Text="Total Balance"
                                                       FontSize="13" FontWeight="SemiBold"
                                                       Foreground="{DynamicResource StatsDetailLabel}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <TextBlock Text="{Binding TotalBalance}"
                                                       FontSize="20" FontWeight="Bold"
                                                       Foreground="{DynamicResource StatsDetailValue}" />
                                            <TextBlock Text="BTC"
                                                       FontSize="13"
                                                       Foreground="{DynamicResource StatsDetailSubtext}"
                                                       VerticalAlignment="Bottom" Margin="0,0,0,2" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Bitcoin stat card -->
                                <Border Background="{DynamicResource StatsDetailInnerBackground}"
                                        BorderBrush="{DynamicResource StatsDetailInnerBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="4,0,4,0">
                                    <StackPanel Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <i:Icon Value="fa-brands fa-bitcoin"
                                                   FontSize="14"
                                                   Foreground="{DynamicResource BitcoinAccent}"
                                                   Opacity="0.7"
                                                   VerticalAlignment="Center" />
                                            <TextBlock Text="Bitcoin"
                                                       FontSize="13" FontWeight="SemiBold"
                                                       Foreground="{DynamicResource StatsDetailLabel}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <TextBlock Text="{Binding BitcoinBalance}"
                                                       FontSize="20" FontWeight="Bold"
                                                       Foreground="{DynamicResource StatsDetailValue}" />
                                            <TextBlock Text="BTC"
                                                       FontSize="13"
                                                       Foreground="{DynamicResource StatsDetailSubtext}"
                                                       VerticalAlignment="Bottom" Margin="0,0,0,2" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <!-- Liquid stat card -->
                                <Border Background="{DynamicResource StatsDetailInnerBackground}"
                                        BorderBrush="{DynamicResource StatsDetailInnerBorder}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="20"
                                        Margin="8,0,0,0">
                                    <StackPanel Spacing="8">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <Viewbox Width="14" Height="14" VerticalAlignment="Center">
                                                <i:Icon Value="fa-solid fa-bolt"
                                                        FontSize="14"
                                                        Foreground="{DynamicResource BitcoinAccent}"
                                                        Opacity="0.7" />
                                            </Viewbox>
                                            <TextBlock Text="Liquid"
                                                       FontSize="13" FontWeight="SemiBold"
                                                       Foreground="{DynamicResource StatsDetailLabel}" />
                                        </StackPanel>
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <TextBlock Text="{Binding LiquidBalance}"
                                                       FontSize="20" FontWeight="Bold"
                                                       Foreground="{DynamicResource StatsDetailValue}" />
                                            <TextBlock Text="BTC"
                                                       FontSize="13"
                                                       Foreground="{DynamicResource StatsDetailSubtext}"
                                                       VerticalAlignment="Bottom" Margin="0,0,0,2" />
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                        </StackPanel>
                    </Border>

                    <!-- ═══ Wallet Groups ═══ -->
                    <!--
                        Vue: .funds-wallet-group — white bg, rounded-2xl (16px), shadow, border
                        Group header: bg #f5f5f5 (dark: #0A0A0A), border-bottom, lock icon + title + balance
                        Wallet list: padding 0 16px 12px
                    -->
                    <ItemsControl ItemsSource="{Binding SeedGroups}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Spacing="24" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="funds:SeedGroupViewModel">
                                <Border Background="{DynamicResource Surface}"
                                        BorderBrush="{DynamicResource Stroke}"
                                        BorderThickness="1"
                                        CornerRadius="16"
                                        ClipToBounds="True"
                                        BoxShadow="{DynamicResource ItemShadow}"
                                        Margin="0,0,0,0">
                                    <StackPanel Spacing="0">
                                        <!-- Group Header -->
                                        <!--
                                            Vue: bg #f5f5f5 dark:#0A0A0A, border-bottom, padding 20px 24px
                                            Lock icon + title + balance (space-between)
                                        -->
                                        <Border Background="{DynamicResource SurfaceMedium}"
                                                CornerRadius="15,15,0,0"
                                                BorderBrush="{DynamicResource Stroke}"
                                                BorderThickness="0,0,0,1"
                                                Padding="24,20">
                                            <Grid ColumnDefinitions="Auto,*,Auto">
                                                <StackPanel Grid.Column="0"
                                                            Orientation="Horizontal" Spacing="12">
                                                    <i:Icon Value="fa-solid fa-lock"
                                                           FontSize="20"
                                                           Foreground="#4B7C5A" />
                                                    <TextBlock Text="{Binding GroupName}"
                                                               FontSize="18"
                                                               FontWeight="Bold"
                                                               Foreground="{DynamicResource TextStrong}"
                                                               VerticalAlignment="Center" />
                                                </StackPanel>
                                                <StackPanel Grid.Column="2"
                                                            Orientation="Horizontal" Spacing="4"
                                                            VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding GroupBalance}"
                                                               FontSize="16" FontWeight="SemiBold"
                                                               Foreground="{DynamicResource TextStrong}" />
                                                    <TextBlock Text="BTC"
                                                               FontSize="13"
                                                               Foreground="{DynamicResource TextMuted}"
                                                               VerticalAlignment="Bottom" Margin="0,0,0,1" />
                                                </StackPanel>
                                            </Grid>
                                        </Border>

                                        <!-- Wallet Cards List -->
                                        <StackPanel Margin="16,12,16,12">
                                            <ItemsControl ItemsSource="{Binding Wallets}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate x:DataType="funds:WalletItemViewModel">
                                                        <controls:WalletCard
                                                            WalletName="{Binding Name}"
                                                            Balance="{Binding Balance}"
                                                            WalletType="{Binding WalletType}" />
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </StackPanel>

                                        <!-- Add Wallet button at bottom of each group -->
                                        <!--
                                            Vue: p-4 border-t, green gradient button, full width
                                            bg: linear-gradient(135deg, #4B7C5A, #3d6448), white text
                                        -->
                                        <Border BorderBrush="{DynamicResource Stroke}"
                                                BorderThickness="0,1,0,0"
                                                Padding="16">
                                            <Button HorizontalAlignment="Stretch"
                                                    HorizontalContentAlignment="Center"
                                                    Padding="16,12"
                                                    CornerRadius="8"
                                                    Foreground="White"
                                                    FontWeight="SemiBold">
                                                <Button.Background>
                                                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                                                        <GradientStop Color="#4B7C5A" Offset="0" />
                                                        <GradientStop Color="#3D6448" Offset="1" />
                                                    </LinearGradientBrush>
                                                </Button.Background>
                                                <StackPanel Orientation="Horizontal" Spacing="8">
                                                    <i:Icon Value="fa-solid fa-plus"
                                                           FontSize="16"
                                                           Foreground="White"
                                                           VerticalAlignment="Center" />
                                                    <TextBlock Text="Add Wallet" VerticalAlignment="Center" />
                                                </StackPanel>
                                            </Button>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                </StackPanel>
            </controls:ScrollableView>
        </Panel>
    </Panel>
</UserControl>
